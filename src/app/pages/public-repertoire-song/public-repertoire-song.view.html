<!-- Komunikat błędu -->
@if (isError && errorData) {
    <div class="error-container">
        <stbo-error-display
            [code]="errorData.code"
            [message]="errorData.message">
        </stbo-error-display>
    </div>
}

<!-- Widok piosenki -->
@if (!isError) {
    <!-- Wskaźnik ładowania -->
    @if (isLoading) {
        <div class="loading-container">
            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
        </div>
    }

    <!-- Główny kontener -->
    @if (!isLoading && isLoaded && loadedSong) {
        <div class="public-repertoire-song-view">
            <!-- Toolbar z przyciskiem powrotu, tytułem i przełącznikiem -->
            <mat-toolbar class="song-toolbar" color="primary">
                @if (navigation().back) {
                    <button
                        mat-icon-button
                        [routerLink]="navigation().back"
                        class="back-button"
                        aria-label="Powrót do repertuaru">
                        <mat-icon>arrow_back</mat-icon>
                    </button>
                }
                <h1 class="song-title">{{ loadedSong.title }}</h1>
                <mat-button-toggle-group
                    [value]="showChords() ? 'chords' : 'text'"
                    (change)="showChords.set($event.value === 'chords')"
                    class="chord-toggle">
                    <mat-button-toggle value="text">Tekst</mat-button-toggle>
                    <mat-button-toggle value="chords">Akordy</mat-button-toggle>
                </mat-button-toggle-group>
            </mat-toolbar>

            <!-- Treść piosenki -->
            <div class="song-content">
                <stbo-song-display
                    [content]="loadedSong.content"
                    [showChords]="showChords()">
                </stbo-song-display>
            </div>

            <!-- Kontrolki nawigacyjne -->
            @if (navigation().previous || navigation().next) {
                <nav class="navigation-controls">
                    @if (navigation().previous) {
                        <a
                            mat-stroked-button
                            [routerLink]="navigation().previous!.link"
                            class="nav-button nav-previous">
                            <mat-icon>chevron_left</mat-icon>
                            <span class="nav-label">{{ navigation().previous!.title }}</span>
                        </a>
                    } @else {
                        <div class="nav-spacer"></div>
                    }

                    @if (navigation().next) {
                        <a
                            mat-stroked-button
                            [routerLink]="navigation().next!.link"
                            class="nav-button nav-next">
                            <span class="nav-label">{{ navigation().next!.title }}</span>
                            <mat-icon>chevron_right</mat-icon>
                        </a>
                    } @else {
                        <div class="nav-spacer"></div>
                    }
                </nav>
            }
        </div>
    }
}

