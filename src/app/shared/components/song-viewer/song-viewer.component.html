<!-- Wskaźnik ładowania -->
@if (isLoading()) {
    <div class="loading-container">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>
}

<!-- Główny kontener -->
@if (!isLoading()) {
    <div class="song-viewer">
        <!-- Toolbar z tytułem i przyciskiem powrotu -->
        <mat-toolbar class="song-toolbar" color="primary">
            @if (navigation().back) {
                <button
                    mat-icon-button
                    [routerLink]="navigation().back"
                    class="back-button"
                    aria-label="Powrót do listy">
                    <mat-icon>arrow_back</mat-icon>
                </button>
            }
            <h1 class="song-title">{{ title() }}</h1>
        </mat-toolbar>

        <!-- Treść piosenki -->
        <div class="song-content-wrapper">
            <div class="song-lyrics-container">
                @if (showChords()) {
                    <!-- Renderowanie z akordami -->
                    <stbo-chord-pro-preview
                        [content]="content()"
                        class="song-content">
                    </stbo-chord-pro-preview>
                } @else {
                    <!-- Renderowanie tylko tekstu (bez akordów) -->
                    <pre class="song-lyrics-plain">{{ content() }}</pre>
                }
            </div>
        </div>

        <!-- Kontrolki nawigacyjne -->
        <nav class="navigation-controls">
            @if (navigation().previous) {
                <a
                    mat-stroked-button
                    [routerLink]="navigation().previous!.link"
                    class="nav-button nav-previous">
                    <mat-icon>chevron_left</mat-icon>
                    <span class="nav-label">{{ navigation().previous!.title }}</span>
                </a>
            } @else {
                <div class="nav-spacer"></div>
            }

            @if (navigation().next) {
                <a
                    mat-stroked-button
                    [routerLink]="navigation().next!.link"
                    class="nav-button nav-next">
                    <span class="nav-label">{{ navigation().next!.title }}</span>
                    <mat-icon>chevron_right</mat-icon>
                </a>
            } @else {
                <div class="nav-spacer"></div>
            }
        </nav>

        <!-- Pływający przycisk akcji (FAB) do pokazywania QR kodu -->
        @if (showQrButton()) {
            <button
                mat-fab
                extended
                color="primary"
                class="qr-fab"
                (click)="handleQrButtonClick()"
                aria-label="Pokaż kod QR">
                <mat-icon>qr_code</mat-icon>
                Udostępnij
            </button>
        }
    </div>
}

